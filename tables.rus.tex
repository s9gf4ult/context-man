\title{Таблицы}

\subject{Общие принципы}

Таблицы в \c верстаются с помощью 3х пар команд.


\startdescr{code:} \hfill
\startTEX
\bTABLE
\bTR
\bTD \tex{bTABLE} / \tex{eTABLE} \eTD
\bTD Начало / конец таблицы \eTD
\eTR

\bTR
\bTD \tex{bTR} / \tex{eTR} \eTD
\bTD Начало / конец строки в таблице \eTD
\eTR

\bTR
\bTD \tex{bTD} / \tex{eTD} \eTD
\bTD Начало / конец ячейки в строке \eTD
\eTR
\eTABLE
\stopTEX
\stopdescr

\startdescr{result:} \hfill
\startCODERESULT
\bTABLE
\bTR
\bTD \tex{bTABLE} / \tex{eTABLE} \eTD
\bTD Начало / конец таблицы \eTD
\eTR

\bTR
\bTD \tex{bTR} / \tex{eTR} \eTD
\bTD Начало / конец строки в таблице \eTD
\eTR

\bTR
\bTD \tex{bTD} / \tex{eTD} \eTD
\bTD Начало / конец ячейки в строке \eTD
\eTR
\eTABLE
\stopCODERESULT
\stopdescr

Пример выше - одновременно пример, и пояснение по командам. Общее правило для
верстки таблиц - это вложенность. На самом верхнем уровне находится таблица. Все
тело таблицы должно быть между \tex{bTABLE} и \tex{eTABLE}. Само тело состоит из
строк, содержание каждой строки таблицы располагается между \tex{bTR} и
\tex{eTR}. Далее, каждая строка содержит в себе ячейки, содержимое которых
располагается между \tex{bTD} и \tex{eTD}.

\vbox{
Вот еще пример таблицы:

\startdescr{code:} \hfill
\startTEX
\bTABLE
\bTR
\bTD 1 \eTD
\bTD 2 \eTD
\bTD 3 \eTD
\bTD 4 \eTD
\bTD 5 \eTD
\bTD 6 \eTD
\eTR

\bTR
\bTD один   \eTD
\bTD два    \eTD
\bTD три    \eTD
\bTD четыре \eTD
\bTD пять   \eTD
\bTD шесть  \eTD
\eTR
\eTABLE
\stopTEX
\stopdescr

\startdescr{result:} \hfill
\startCODERESULT
\bTABLE
\bTR
\bTD 1 \eTD
\bTD 2 \eTD
\bTD 3 \eTD
\bTD 4 \eTD
\bTD 5 \eTD
\bTD 6 \eTD
\eTR

\bTR
\bTD один   \eTD
\bTD два    \eTD
\bTD три    \eTD
\bTD четыре \eTD
\bTD пять   \eTD
\bTD шесть  \eTD
\eTR
\eTABLE
\stopCODERESULT
\stopdescr
}

Обратите внимание, как создается таблица: все тело таблицы располагается между
команд \tex{bTABLE} и \tex{eTABLE}. Далее, состоит тело из двух строк, каждая
строка начинается с \tex{bTR} и заканчивается \tex{eTR}. Пустые между строками
не имеют никакого значения, это не параграфы, как в простом тексте, а разметка
таблицы. Внутри каждой строки описаны 6 ячеек, содержимое каждой ячейки вводится
между командами \tex{bTD} и \tex{eTD}.

\subject{Объединенные ячейки}

Объединенные ячейки создаются с помощью опциональных аргументов для команды
\tex{bTD}.

\placetable[here]{Аргументы \tex{bTD} для создания объединенных ячеек}{
\bTABLE

\bTR
\bTD nc \eTD
\bTD Количество колонок, занимаемое ячейкой. \eTD
\eTR

\bTR
\bTD nr \eTD
\bTD Количество строк, занимаемое ячейкой. \eTD
\eTR

\eTABLE}

И сразу пример:

\vbox{
\startdescr{code:} \hfill
\startTEX
\bTABLE
\bTR
\bTD[nc=2] Эта ячейка занимает две колонки \eTD
\eTR

\bTR
\bTD Простая ячейка \eTD
\bTD Тоже простая \eTD
\eTR
\eTABLE
\stopTEX
\stopdescr
}

\vbox{
\startdescr{result:} \hfill
\startCODERESULT
\bTABLE
\bTR
\bTD[nc=2] Эта ячейка занимает две колонки \eTD
\eTR

\bTR
\bTD Простая ячейка \eTD
\bTD Тоже простая \eTD
\eTR
\eTABLE
\stopCODERESULT
\stopdescr
}

Обратите внимане, что первая строка в таблице содержит лишь одну ячейку, но эта
колонка занимает сразу две ячейки. Вторая же строка содержит две ячейки и они
верстаются как обычно.

\vbox{
Теперь пример с многострочной ячейкой:

\startdescr{code:} \hfill
\startTEX
\bTABLE
\bTR
\bTD[nr=2] Ячейка занимает две стркои \eTD
\bTD обычная ячейка \eTD
\eTR

\bTR
\bTD тоже обычная \eTD
\eTR
\eTABLE
\stopTEX
\stopdescr
}

\vbox{
\startdescr{result:} \hfill
\startCODERESULT
\bTABLE
\bTR
\bTD[nr=2] Ячейка занимает две стркои \eTD
\bTD обычная ячейка \eTD
\eTR

\bTR
\bTD тоже обычная \eTD
\eTR
\eTABLE
\stopCODERESULT
\stopdescr
}

Тут все немного менее очевидно. Для начала, мы видим, что в первой строке
указано две ячейки, тогда как во второй только одна. Дело в том, что
многостроковая ячейка занимает, в данном случае, две строки: свою, первую
строку, и следующую. Таким образом, во второй строке первая колонка уже занята
многострочной ячейкой из предыдущей строки.

Вот еще пример:

\vbox{
\startdescr{code:} \hfill
\startTEX
\bTABLE
\bTR
\bTD[nr=3] Ячейка занимает три стркои, свою и две нижних.
Первая колонка в следующих двух строках уже занята этой
ячейкой. \eTD
\bTD обычная ячейка \eTD
\eTR

\bTR
\bTD тоже обычная \eTD
\eTR

\bTR
\bTD опять простая \eTD
\eTR
\eTABLE
\stopTEX
\stopdescr
}

\vbox{
\startdescr{result:} \hfill
\startCODERESULT
\bTABLE
\bTR
\bTD[nr=3] Ячейка занимает три стркои, свою и две нижних.
Первая колонка в следующих двух строках уже занята этой
ячейкой. \eTD
\bTD обычная ячейка \eTD
\eTR

\bTR
\bTD тоже обычная \eTD
\eTR

\bTR
\bTD опять простая \eTD
\eTR
\eTABLE
\stopCODERESULT
\stopdescr
}

Более сложный пример:

\vbox{
\startdescr{code:} \hfill
\startTEX
\bTABLE
\bTR
\bTD[nr=3] Ячейка занимает три стркои, свою и две нижних.
Первая колонка в следующих двух строках уже занята этой
ячейкой. \eTD
\bTD обычная ячейка \eTD
\bTD[nr=2] Ячейка занимает две строки, свою и следующую. \eTD
\eTR

\bTR
\bTD тоже обычная \eTD
\eTR

\bTR
\bTD опять простая \eTD
\bTD на этой строке верхняя ячейка уже не распространяется. \eTD
\eTR
\eTABLE
\stopTEX
\stopdescr
}

\vbox{
\startdescr{result:} \hfill
\startCODERESULT
\bTABLE
\bTR
\bTD[nr=3] Ячейка занимает три стркои, свою и две нижних.
Первая колонка в следующих двух строках уже занята этой
ячейкой. \eTD
\bTD обычная ячейка \eTD
\bTD[nr=2] Ячейка занимает две строки, свою и следующую. \eTD
\eTR

\bTR
\bTD тоже обычная \eTD
\eTR

\bTR
\bTD опять простая \eTD
\bTD на этой строке верхняя ячейка уже не распространяется. \eTD
\eTR
\eTABLE
\stopCODERESULT
\stopdescr
}

Сосредоточим внимание на первой строке. Первая ячейка распространяется на 3
строки, а третья на 2. Это значит, что во второй строке первая колонка уже
занята первой ячейкой из первой строки, вторая свободна, и третья снова занята
ячейкой из первой строки. Именно это мы и наблюдаем в верстке: во второй ктроке
описана только одна колонка.

Теперь посмотрим на третью строку. В ней первая колонка уже занята многострочной
ячейкой, тогда как вторая и третья свободны. Именно они и описаны в верстке.

Это более заменто на немного подифицированном примере:

\vbox{
\startdescr{code:} \hfill
\startTEX
\bTABLE
\bTR
\bTD[nr=3] Ячейка занимает три стркои, свою и две нижних.
Первая колонка в следующих двух строках уже занята этой
ячейкой. \eTD
\bTD обычная ячейка \eTD
\bTD[nr=2] Ячейка занимает две строки, свою и следующую. \eTD
\bTD 1 \eTD
\eTR

\bTR
% \bTD эта колонка уже занята многострочной ячейкой
\bTD тоже обычная \eTD
% \bTD эта колонка уже занята многострочной ячейкой
\bTD 2 \eTD
\eTR

\bTR
% \bTD эта колонка уже занята многострочной ячейкой
\bTD опять простая \eTD
\bTD на этой строке верхняя ячейка уже не распространяется. \eTD
\bTD 3 \eTD
\eTR
\eTABLE
\stopTEX
\stopdescr
}

\vbox{
\startdescr{result:} \hfill
\startCODERESULT
\bTABLE
\bTR
\bTD[nr=3] Ячейка занимает три стркои, свою и две нижних.
Первая колонка в следующих двух строках уже занята этой
ячейкой. \eTD
\bTD обычная ячейка \eTD
\bTD[nr=2] Ячейка занимает две строки, свою и следующую. \eTD
\bTD 1 \eTD
\eTR

\bTR
\bTD тоже обычная \eTD
\bTD 2 \eTD
\eTR

\bTR
\bTD опять простая \eTD
\bTD на этой строке верхняя ячейка уже не распространяется. \eTD
\bTD 3 \eTD
\eTR
\eTABLE
\stopCODERESULT
\stopdescr
}

\startitemize
\item Строчка 1: 4 колонки, в первой колонке многострочная ячейка, занимающая 3
  строчки, затем простая ячейка, затем снова многострочная, занимающая 2 строки
  и в конце снова простая.

\item Строчка 2: первая колонка уже занята, вторая колонка - обычная ячейка,
  третья ячейка тоже занята многострочной ячейкой, в четвертой колонке обычная
  ячейка.

\item Строчка 3: первая колонка узе занята, остальные колонки свободны и в них
  находятся обычные ячейки.
\stopitemize


Вот вполне реальный пример полезной таблицы:

\vbox{
\startdescr{code:} \hfill
\startTEX
\bTABLE
\setupTABLE[column][2,3,4,5,6][width=2.5cm]
\setupTABLE[align={lohi,middle}]
\bTR
\bTD[nr=2,nc=2] Таблица вычитания \eTD
\bTD[nc=2] Четные \eTD
\bTD[nc=2] Нечетные \eTD
\eTR

\bTR
\bTD 2 \eTD
\bTD 4 \eTD
\bTD 1 \eTD
\bTD 3 \eTD
\eTR

\bTR
\bTD[nr=2] Четные \eTD
\bTD 6 \eTD

\bTD 4 \eTD
\bTD 2 \eTD
\bTD 5 \eTD
\bTD 3 \eTD
\eTR

\bTR
\bTD 8 \eTD

\bTD 6 \eTD
\bTD 4 \eTD
\bTD 7 \eTD
\bTD 5 \eTD
\eTR
\stopTEX
\stopdescr
}

\vbox{
\startdescr{continue code:} \hfill
\startTEX
\bTR
\bTD[nr=2] Нечетные \eTD
\bTD 5 \eTD
\bTD 3 \eTD
\bTD 1 \eTD
\bTD 4 \eTD
\bTD 2 \eTD
\eTR

\bTR
\bTD 7 \eTD
\bTD 5 \eTD
\bTD 3 \eTD
\bTD 6 \eTD
\bTD 4 \eTD
\eTR

\eTABLE
\stopTEX
\stopdescr
}

\vbox{
\startdescr{result:} \hfill
\startCODERESULT
\bTABLE
\setupTABLE[column][2,3,4,5,6][width=2.5cm]
\setupTABLE[align={lohi,middle}]
\bTR
\bTD[nr=2,nc=2] Таблица вычитания \eTD
\bTD[nc=2] Четные \eTD
\bTD[nc=2] Нечетные \eTD
\eTR

\bTR
\bTD 2 \eTD
\bTD 4 \eTD
\bTD 1 \eTD
\bTD 3 \eTD
\eTR

\bTR
\bTD[nr=2] Четные \eTD
\bTD 6 \eTD

\bTD 4 \eTD
\bTD 2 \eTD
\bTD 5 \eTD
\bTD 3 \eTD
\eTR

\bTR
\bTD 8 \eTD

\bTD 6 \eTD
\bTD 4 \eTD
\bTD 7 \eTD
\bTD 5 \eTD
\eTR

\bTR
\bTD[nr=2] Нечетные \eTD
\bTD 5 \eTD
\bTD 3 \eTD
\bTD 1 \eTD
\bTD 4 \eTD
\bTD 2 \eTD
\eTR

\bTR
\bTD 7 \eTD
\bTD 5 \eTD
\bTD 3 \eTD
\bTD 6 \eTD
\bTD 4 \eTD
\eTR

\eTABLE
\stopCODERESULT
\stopdescr
}

Не обращайте внимания на команду \tex{setupTABLE}, она рассматривается ниже.

Выглядит довольно громоздко, вообще, верстка таблиц с помощью текстовой разметки
- не самое приятное занятие, но, зато, верстать все остальное гораздо проще и
приятнее с помощью \c.

\subject{Конфигурация таблиц}

Таблицы настраиваются с помощью команды \tex{setupTABLE}. У нее есть несколько
необязательных аргументов, в зависимости от того, сколько аргмументов ей
передать, результат ее работы будет разный.

Есть несколько способов вызвать команду \tex{setupTABLE}

\startTEX
\setupTABLE[параметры таблицы]
\stopTEX

Если мы передаем один необязательный параметр, то он рассматривается как
настройка для всей таблицы. О возможных параметрах для таблицы будет ниже, пока
разберемся с вызовом \tex{setupTABLE}.

\vbox{
\startdescr{code:} \hfill
\startTEX
\bTABLE
\setupTABLE[width=2cm]
\bTR
\bTD 1 \eTD
\bTD 2 \eTD
\eTR

\bTR
\bTD 3 \eTD
\bTD 4 \eTD
\eTR
\eTABLE
\stopTEX
\stopdescr
}

\vbox{
\startdescr{result:} \hfill
\startCODERESULT
\bTABLE
\setupTABLE[width=2cm]
\bTR
\bTD 1 \eTD
\bTD 2 \eTD
\eTR

\bTR
\bTD 3 \eTD
\bTD 4 \eTD
\eTR
\eTABLE
\stopCODERESULT
\stopdescr
}

Команда \tex{setupTABLE} вызвана с одним аргументом. Поэтому \quote{width=2cm} применяется к каждой ячейке таблицы.

Если передать три параметра, то они будут разобраны следующим образом:

\startTEX
\setupTABLE[column][номера колонок][настройки для колонки]
\setupTABLE[row][номера строк][настройки для строки]
\stopTEX

Первый аргумент - это \quote{column} либо \quote{row}, что говорит, что
дальнейшие параметры описывают настройки для колонок, либо для таблиц.

Второй аргумент - это номера колонок, либо строк. Номера можно перечислять через
запятую:

\vbox{
\startdescr{code:} \hfill
\startTEX
\bTABLE
\setupTABLE[column][1][background=color,backgroundcolor=red]
\setupTABLE[column][2,3,4][background=color,backgroundcolor=blue]
\setupTABLE[column][5][background=color,backgroundcolor=green]
\bTR
\bTD 1 \eTD
\bTD 2 \eTD
\bTD 3 \eTD
\bTD 4 \eTD
\bTD 5 \eTD
\eTR
\eTABLE
\stopTEX
\stopdescr
}

\vbox{
\startdescr{result:} \hfill
\startCODERESULT
\bTABLE
\setupTABLE[column][1][background=color,backgroundcolor=red]
\setupTABLE[column][2,3,4][background=color,backgroundcolor=blue]
\setupTABLE[column][5][background=color,backgroundcolor=green]
\bTR
\bTD 1 \eTD
\bTD 2 \eTD
\bTD 3 \eTD
\bTD 4 \eTD
\bTD 5 \eTD
\eTR
\eTABLE
\stopCODERESULT
\stopdescr
}

Также, номера могут иметь значение \quote{even} или \quote{odd}, что означаете
четные и нечетные номера соответственно.

\vbox{
\startdescr{code:} \hfill
\startTEX
\bTABLE
\setupTABLE[column][even]
           [width=1cm,background=color,backgroundcolor=blue]
\setupTABLE[column][odd]
           [background=color,backgroundcolor=green]
\bTR
\bTD 1 \eTD
\bTD 2 \eTD
\bTD 3 \eTD
\bTD 4 \eTD
\bTD 5 \eTD
\bTD 6 \eTD
\bTD 7 \eTD
\eTR
\eTABLE
\stopTEX
\stopdescr
}

\vbox{
\startdescr{result:} \hfill
\startCODERESULT
\bTABLE
\setupTABLE[column][even]
           [width=1cm,background=color,backgroundcolor=blue]
\setupTABLE[column][odd]
           [background=color,backgroundcolor=green]
\bTR
\bTD 1 \eTD
\bTD 2 \eTD
\bTD 3 \eTD
\bTD 4 \eTD
\bTD 5 \eTD
\bTD 6 \eTD
\bTD 7 \eTD
\eTR
\eTABLE
\stopCODERESULT
\stopdescr
}

Теперь о параметрах ячеек.

\placetable[here,split]{Параметры ячеек для \tex{setupTABLE}}{
\bTABLE[split=yes]
\setupTABLE[column][3][width=4cm]
\bTR
\bTD Параметр \eTD
\bTD Значение \eTD
\bTD Описание \eTD
\bTD Пример \eTD
\eTR

\bTR
\bTD width \eTD
\bTD Длина \eTD
\bTD Задает ширину ячейки. \eTD
\bTD width=2cm \eTD
\eTR

\bTR
\bTD height \eTD
\bTD Длина \eTD
\bTD Задает высоту ячейки. \eTD
\bTD height=2em \eTD
\eTR

\bTR
\bTD align \eTD
\bTD Опции вырванивания текста, такие же, как для команды \tex{startalignment},
за исключением дополнительных значений \eTD
\bTD Задает выравнивание  \eTD
\bTD align=\{middle,lohi\} \eTD
\eTR

\bTR
\bTD background \eTD
\bTD \quote{color}, возможно другие. Если указано значение \quote{color} то
подложка заливается одним цветом, а параметр \quote{backgroundcolor} укзывает,
каким. \eTD
\bTD Задает тип подложки для ячейки \eTD
\bTD background=color \eTD
\eTR

\bTR
\bTD backgroundcolor \eTD
\bTD Нвазвание цвета. Есть предопределенные цвета, вроде \quote{red},
\quote{blue}, \quote{lightgray} \eTD
\bTD Задает цвет подложки ячейки. \eTD
\bTD backgroundcolor=lightgray\eTD
\eTR

\bTR
\bTD split\eTD
\bTD yes/no\eTD
\bTD Разрешает разбиение таблицы на несколько страниц\eTD
\bTD split=yes\eTD
\eTR

\bTR
\bTD frame\eTD
\bTD on / off. Если \quote{frmae=off}, то рамки вокруг ячейки не будет\eTD
\bTD Включает / выключает рамку.\eTD
\bTD frame=off\eTD
\eTR

\bTR
\bTD topframe \\
leftframe \\
rightframe \\
bottomframe \eTD
\bTD on / off\eTD
\bTD Вкл/выкл рамку у конкретной стороны ячейки\eTD
\bTD leftframe=off\eTD
\eTR
\eTABLE}

\subject{Выравнивание текста в таблицах}

Чтобы настроить вырванивание внутри ячейки таблицы используется параметр
\quote{align} команды \tex{setupTABLE}. Если настройки вырванивания сложные, то
есть, состоят из нескольких правил, то эти правила группируются с помощью
фигурных скобок \{ \}.

\vbox{
\startdescr{code:} \hfill
\startTEX
\bTABLE
\setupTABLE[width=\dimexpr((\textwidth-1cm)/3),height=20cm]
\setupTABLE[column][1][align={flushleft,tolerant,nothyphenated}]
\setupTABLE[column][2][align={middle,morehyphenation,lohi},frame=off]
\setupTABLE[column][3][align={width,stretch,tolerant,low}]
\bTR
\bTD \input weisman \eTD
\bTD \input weisman \eTD
\bTD \input weisman \eTD
\eTR
\eTABLE
\stopTEX
\stopdescr
}

\vbox{
\startdescr{result:} \hfill
\startCODERESULT
\bTABLE
\setupTABLE[width=\dimexpr((\textwidth-1cm-2mm)/3),height=20cm]
\setupTABLE[column][1][align={flushleft,tolerant,nothyphenated}]
\setupTABLE[column][2][align={middle,morehyphenation,lohi},frame=off]
\setupTABLE[column][3][align={width,stretch,tolerant,low}]
\bTR
\bTD \input weisman \eTD
\bTD \input weisman \eTD
\bTD \input weisman \eTD
\eTR
\eTABLE
\stopCODERESULT
\stopdescr
}

Обратите внимание на то, как мы сделали все колонки одинаковой ширины с помощью
\tex{dimexpr}.

Значение \quote{align} задано в фигурных скобках. Если бы этих скобок не было,
\c не смог бы отличить значение для \quote{align} от идущей после него опции,
как в опции для второй колонки. Кроме того, тут у нас появились новые опции для
\quote{align}: \quote{lohi} и \quote{low}.

\placetable[here]{Дополнительные значения для \quote{align} в таблицах}{
\bTABLE
\bTR
\bTD lohi\eTD
\bTD Цертрирует содержание ячейки по вертикали\eTD
\eTR

\bTR
\bTD low\eTD
\bTD Прижимает содержание ячейки к низу\eTD
\eTR

\bTR
\bTD high\eTD
\bTD Прижимает содержимое ячейки к верху, именно так происходит по умолчанию\eTD
\eTR
\eTABLE}

Больше информации можно найти в
\goto{документации}[url(http://wiki.contextgarden.net/TABLE)]
